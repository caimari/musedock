# ===============================================
# MUSEDOCK CMS - ENVIRONMENT CONFIGURATION
# ===============================================
# IMPORTANT: Copy this file to .env and update values
# DO NOT upload .env file to your repository (must be in .gitignore)

# --- APPLICATION ---
APP_ENV=production
APP_DEBUG=false
APP_NAME="MuseDock CMS"
APP_URL=https://your-domain.com

# Application key (generate with: php -r "echo bin2hex(random_bytes(32));")
APP_KEY=

# --- DATABASE ---
# Driver: mysql or pgsql (postgresql)
DB_DRIVER=mysql
DB_HOST=localhost
DB_PORT=3306
DB_NAME=
DB_USER=
DB_PASS=

# --- CLOUD STORAGE (Optional) ---

# Cloudflare R2 Configuration
R2_ACCESS_KEY_ID=
R2_SECRET_ACCESS_KEY=
R2_BUCKET=
R2_ENDPOINT=
R2_URL=

# Amazon S3 Configuration
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=eu-west-1
AWS_BUCKET=
AWS_URL=

# --- SESSIONS ---
SESSION_LIFETIME=7200
SESSION_SECURE=true
SESSION_HTTPONLY=true
SESSION_SAMESITE=Strict

# --- REDIS (For WebSocket and real-time notifications) ---
# Enable only if you have Redis installed
REDIS_ENABLED=false
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DATABASE=0
REDIS_TIMEOUT=2.5

# --- WEBSOCKET (Real-time notifications) ---
# Port where WebSocket server will run
# Run: php websocket-server.php
WEBSOCKET_ENABLED=false
WEBSOCKET_HOST=0.0.0.0
WEBSOCKET_PORT=8080

# --- RATE LIMITING ---
RATE_LIMIT_ATTEMPTS=5
RATE_LIMIT_DECAY_MINUTES=15

# --- FILE UPLOADS ---
UPLOAD_MAX_SIZE=10485760
ALLOWED_IMAGE_MIMES=image/jpeg,image/png,image/gif,image/webp
ALLOWED_DOCUMENT_MIMES=application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document
ALLOWED_EXTENSIONS=jpg,jpeg,png,gif,webp,pdf,doc,docx

# --- STORAGE / MEDIA MANAGER (Tenant configuration) ---
# Controls which storage disks are available for tenants
# Disabled disks won't appear in Media Manager selector for tenants
# Superadmin always has access to all configured disks

# Secure local disk (/storage/app/media/) - Recommended for development
TENANT_DISK_MEDIA_ENABLED=true

# Legacy local disk (/public/assets/uploads/) - Deprecated, read-only recommended
TENANT_DISK_LOCAL_ENABLED=false

# Cloudflare R2 CDN - Recommended for production
TENANT_DISK_R2_ENABLED=true

# Amazon S3
TENANT_DISK_S3_ENABLED=false

# Default storage quota for new tenants (in MB)
# 1024 MB = 1 GB (free plan default)
TENANT_DEFAULT_STORAGE_QUOTA_MB=1024

# --- LOGS ---
LOG_LEVEL=warning
LOG_MAX_FILES=30
LOG_PATH=/storage/logs/error.log

# --- PASSWORD SECURITY ---
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=true
PASSWORD_RESET_EXPIRY=60

# --- MULTI-TENANT ---
# Enable multi-tenancy system (multiple domains)
# false = Classic mode (single site) - RECOMMENDED for new installations
# true = Multi-tenant mode (multiple sites/domains from single panel)
MULTI_TENANT_ENABLED=false

# Main system domain (only needed if MULTI_TENANT_ENABLED=true)
# This domain will show superadmin panel (/musedock) and main site
MAIN_DOMAIN=localhost

# Default settings
DEFAULT_THEME=default
DEFAULT_LANG=en

# Admin panel routes
ADMIN_PATH_TENANT=admin
ADMIN_PATH_MUSEDOCK=musedock

# ===============================================
# EMAIL / MAIL
# ===============================================

# --- GENERAL CONFIGURATION ---
# Sending method: 'mail' or 'smtp'
# - 'mail': Uses PHP mail() function (simpler, requires server configuration)
# - 'smtp': Uses external SMTP server (Gmail, SendGrid, Mailgun, etc.)
MAIL_DRIVER=mail

# Default sender
MAIL_FROM_ADDRESS=noreply@your-domain.com
MAIL_FROM_NAME="MuseDock CMS"

# --- SMTP CONFIGURATION (Only if MAIL_DRIVER=smtp) ---
# Uncomment and configure if using MAIL_DRIVER=smtp

# Gmail (requires "App Password" if using 2FA)
#SMTP_HOST=smtp.gmail.com
#SMTP_PORT=587
#SMTP_USERNAME=your-email@gmail.com
#SMTP_PASSWORD=your-16-character-app-password
#SMTP_ENCRYPTION=tls

# Outlook/Office365
#SMTP_HOST=smtp.office365.com
#SMTP_PORT=587
#SMTP_USERNAME=your-email@outlook.com
#SMTP_PASSWORD=your-password
#SMTP_ENCRYPTION=tls

# SendGrid
#SMTP_HOST=smtp.sendgrid.net
#SMTP_PORT=587
#SMTP_USERNAME=apikey
#SMTP_PASSWORD=your-sendgrid-api-key
#SMTP_ENCRYPTION=tls

# Mailgun
#SMTP_HOST=smtp.mailgun.org
#SMTP_PORT=587
#SMTP_USERNAME=postmaster@your-mailgun-domain
#SMTP_PASSWORD=your-mailgun-password
#SMTP_ENCRYPTION=tls

# Amazon SES
#SMTP_HOST=email-smtp.us-east-1.amazonaws.com
#SMTP_PORT=587
#SMTP_USERNAME=your-smtp-username
#SMTP_PASSWORD=your-smtp-password
#SMTP_ENCRYPTION=tls

# Custom SMTP server
#SMTP_HOST=mail.your-domain.com
#SMTP_PORT=587
#SMTP_USERNAME=your-email@your-domain.com
#SMTP_PASSWORD=your-password
#SMTP_ENCRYPTION=tls

# Encryption options:
# - tls: STARTTLS (port 587) - Recommended
# - ssl: SSL/TLS direct (port 465)
# - (empty): No encryption (port 25) - Not recommended

# ===============================================
# SCHEDULED TASKS (CRON/PSEUDO-CRON)
# ===============================================

# --- EXECUTION MODE ---
# Options: pseudo | real | disabled
# - pseudo: Runs on each request (with throttle) - shared hosting
# - real: Runs via system crontab - VPS/dedicated hosting
# - disabled: Disable scheduled tasks
CRON_MODE=pseudo

# --- PSEUDO-CRON: EXECUTION INTERVAL ---
# Only applies if CRON_MODE=pseudo
# Minimum time in seconds between executions (prevents overload)
# Recommended values: 3600 (1 hour), 7200 (2 hours), 86400 (1 day)
PSEUDO_CRON_INTERVAL=3600

# ===============================================
# AUTOMATIC TRASH CLEANUP
# ===============================================

# --- ENABLE/DISABLE ---
TRASH_AUTO_DELETE_ENABLED=true

# --- RETENTION DAYS ---
# Number of days before permanent deletion
# Default: 30 days (similar to Gmail, Outlook)
TRASH_RETENTION_DAYS=30

# --- NOTIFICATIONS ---
# Notify user before deletion (days in advance)
# 0 = no prior notification
TRASH_NOTIFY_BEFORE_DAYS=7

# ===============================================
# AUTOMATIC REVISION CLEANUP
# ===============================================

# --- ENABLE/DISABLE ---
REVISION_CLEANUP_ENABLED=true

# --- MIXED RETENTION POLICY ---

# 1. Recent revisions (always keep)
# Last N revisions: NEVER deleted
REVISION_KEEP_RECENT=5

# 2. Old revisions (1 per month)
# Keep 1 revision per month for the last X months
# Example: 12 = keep 1 revision/month for last year
REVISION_KEEP_MONTHLY=12

# 3. Very old revisions (1 per year)
# Keep 1 revision per year for the last X years
# Example: 3 = keep 1 revision/year for last 3 years
REVISION_KEEP_YEARLY=3

# NOTE: Revisions older than these limits are deleted

# ===============================================
# MARKETPLACE
# ===============================================

# --- ENABLE/DISABLE MARKETPLACE ---
# Marketplace allows installing modules, plugins and themes from central repository
# true = Marketplace enabled (shows menu and allows installations)
# false = Marketplace disabled (hides menu and blocks access)
MARKETPLACE_ENABLED=false

# Marketplace server URL (only if you have your own)
# Default uses: https://api.musedock.org/v1/marketplace
#MARKETPLACE_API_URL=https://api.musedock.org/v1/marketplace


# ===============================================
# WEB ANALYTICS
# ===============================================
# Activar/desactivar el sistema de analytics
ANALYTICS_ENABLED=true

# Rastrear visitas en entorno de desarrollo
ANALYTICS_IN_DEV=false

# Rastrear visitas de administradores logueados
ANALYTICS_TRACK_ADMINS=false

# Duración de la cookie de visitante (días)
ANALYTICS_COOKIE_LIFETIME=365

# Timeout de sesión (minutos) - después de este tiempo sin actividad se considera nueva sesión
ANALYTICS_SESSION_TIMEOUT=30

# Anonimizar IPs para cumplir con GDPR (recomendado: true)
ANALYTICS_ANONYMIZE_IP=true

# Respetar la cabecera "Do Not Track" del navegador
ANALYTICS_RESPECT_DNT=true

# ===============================================
# CLOUDFLARE API CONFIGURATION
# ===============================================
# Get your API Token: https://dash.cloudflare.com/profile/api-tokens
# Required permissions: Zone.DNS.Edit, Zone.Zone.Read, Zone.SSL.Edit, Account.Email Routing.Edit

# API Token (create one with DNS edit permissions)
CLOUDFLARE_API_TOKEN=

# Zone ID (find in Cloudflare dashboard → your domain → Overview → Zone ID)
CLOUDFLARE_ZONE_ID=

# Account ID (find in Cloudflare dashboard → your domain → Overview → Account ID)
CLOUDFLARE_ACCOUNT_ID=

# SSL Mode between Cloudflare and your origin server
# Options: full | full_strict | flexible
# Recommended: full_strict (requires valid SSL certificate on origin)
CLOUDFLARE_SSL_MODE=full_strict

# ===============================================
# CADDY API CONFIGURATION
# ===============================================
# Caddy is used as reverse proxy and automatic SSL certificate manager

# Caddy API URL (default: http://localhost:2019)
CADDY_API_URL=http://localhost:2019

# PHP-FPM Socket path (adjust to your PHP version)
# Common paths:
# - Ubuntu/Debian: unix//run/php/php8.3-fpm.sock
# - CentOS/RHEL: unix//var/run/php-fpm/www.sock
PHP_FPM_SOCKET=unix//run/php/php8.3-fpm.sock

# Document root for Caddy (public folder of your installation)
CADDY_DOCUMENT_ROOT=/var/www/html/public

# ===============================================
# MULTI-TENANT DOMAIN CONFIGURATION
# ===============================================

# Base domain for FREE subdomains (e.g., customer.musedock.com)
TENANT_BASE_DOMAIN=musedock.com

# Enable automatic subdomain creation via Cloudflare API for FREE plan
TENANT_CLOUDFLARE_SUBDOMAIN_ENABLED=true

# Enable Cloudflare proxy (orange cloud) for subdomains
# Provides: DDoS protection, WAF, caching, analytics
TENANT_CLOUDFLARE_PROXY_ENABLED=true

# ===============================================
# CUSTOMER PORTAL CONFIGURATION
# ===============================================

# Enable public customer registration
CUSTOMER_REGISTRATION_ENABLED=true

# Allow customers to register FREE subdomains (.musedock.com)
CUSTOMER_FREE_SUBDOMAIN_ENABLED=true

# ===============================================
# PADDLE CONFIGURATION (Payment Processing)
# ===============================================
# Paddle handles payments, VAT, invoicing for EU/Global customers
# Sign up: https://www.paddle.com/

# Paddle Vendor ID (find in Paddle dashboard → Developer Tools → Authentication)
PADDLE_VENDOR_ID=

# Paddle API Key (generate in Paddle dashboard → Developer Tools → Authentication)
PADDLE_API_KEY=

# Paddle Public Key (used to verify webhook signatures)
# Find in: Paddle dashboard → Developer Tools → Public Key
PADDLE_PUBLIC_KEY=

# Paddle Webhook Secret (used to verify webhook authenticity)
# Configure in: Paddle dashboard → Developer Tools → Webhooks
PADDLE_WEBHOOK_SECRET=

# Environment: sandbox (testing) | production (live payments)
PADDLE_ENVIRONMENT=sandbox

# ===============================================
# OPENPROVIDER CONFIGURATION (Domain Registration)
# ===============================================
# OpenProvider is used to register/purchase custom domains
# Sign up: https://www.openprovider.com/

# OpenProvider API username
OPENPROVIDER_USERNAME=

# OpenProvider API password
OPENPROVIDER_PASSWORD=

# OpenProvider API URL (default: production endpoint)
OPENPROVIDER_API_URL=https://api.openprovider.eu